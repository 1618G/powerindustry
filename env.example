# ZZA Platform Starter - Enterprise Environment Variables
# Copy this file to .env and fill in your values
# SOC II Compliant | Marketplace & SaaS Ready

# ============================================
# Core Settings
# ============================================

# Application
APP_NAME="Power Industry"
APP_URL="http://localhost:1212"
NODE_ENV="development"

# Database (with connection pooling for production)
# connection_limit: Max connections per worker (100 total / 4 PM2 workers = 25 per worker)
# pool_timeout: Seconds to wait for a connection from pool
# connect_timeout: Seconds to wait for initial connection
DATABASE_URL="postgresql://dev:dev@localhost:5432/powerindustry_dev?schema=public&connection_limit=25&pool_timeout=10&connect_timeout=10"

# Redis (Caching & Sessions) - Required for production
REDIS_URL="redis://localhost:6379"

# Session (generate with: openssl rand -hex 32)
SESSION_SECRET="your-secret-here-minimum-32-characters-long"

# Encryption Key for sensitive data (generate with: openssl rand -hex 32)
ENCRYPTION_KEY=""

# ============================================
# Platform Type
# ============================================

# Platform mode: "saas" | "marketplace" | "both"
PLATFORM_TYPE="saas"

# ============================================
# Stripe (Payments & Subscriptions)
# ============================================

# Core Stripe keys
STRIPE_SECRET_KEY="sk_test_..."
STRIPE_PUBLISHABLE_KEY="pk_test_..."
STRIPE_WEBHOOK_SECRET="whsec_..."

# Stripe Connect (for Marketplace mode)
STRIPE_CONNECT_CLIENT_ID=""

# Default pricing
STRIPE_PRICE_STARTER=""
STRIPE_PRICE_PROFESSIONAL=""
STRIPE_PRICE_ENTERPRISE=""

# ============================================
# Email Provider (choose one)
# ============================================

# Provider selection: "sendgrid" | "gmail" | "smtp"
EMAIL_PROVIDER="sendgrid"

# SendGrid (recommended for production)
SENDGRID_API_KEY=""
SENDGRID_FROM_EMAIL="noreply@yourdomain.com"
SENDGRID_FROM_NAME="ZZA Platform"

# Gmail (via Google Cloud / OAuth)
GMAIL_CLIENT_ID=""
GMAIL_CLIENT_SECRET=""
GMAIL_REFRESH_TOKEN=""
GMAIL_FROM_EMAIL=""

# SMTP (fallback/development)
SMTP_HOST="smtp.mailtrap.io"
SMTP_PORT="587"
SMTP_SECURE="false"
SMTP_USER=""
SMTP_PASS=""
SMTP_FROM_EMAIL="noreply@example.com"
SMTP_FROM_NAME="ZZA Platform"

# ============================================
# Authentication
# ============================================

# Clerk (Primary - Production Recommended)
CLERK_PUBLISHABLE_KEY="pk_test_..."
CLERK_SECRET_KEY="sk_test_..."

# ============================================
# OAuth Providers (Legacy/Fallback - use Clerk instead)
# ============================================

# Google OAuth
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""
GOOGLE_CALLBACK_URL="http://localhost:1212/auth/google/callback"

# GitHub OAuth
GITHUB_CLIENT_ID=""
GITHUB_CLIENT_SECRET=""
GITHUB_CALLBACK_URL="http://localhost:1212/auth/github/callback"

# Microsoft OAuth
MICROSOFT_CLIENT_ID=""
MICROSOFT_CLIENT_SECRET=""
MICROSOFT_TENANT_ID="common"
MICROSOFT_CALLBACK_URL="http://localhost:1212/auth/microsoft/callback"

# ============================================
# AI Services
# ============================================

# Default AI provider: "openai" | "gemini" | "anthropic"
AI_DEFAULT_PROVIDER="openai"

# OpenAI
OPENAI_API_KEY=""
OPENAI_CHAT_MODEL="gpt-4-turbo-preview"

# Google Gemini
GOOGLE_AI_API_KEY=""
GEMINI_CHAT_MODEL="gemini-pro"

# Anthropic Claude
ANTHROPIC_API_KEY=""
ANTHROPIC_CHAT_MODEL="claude-3-sonnet-20240229"

# ============================================
# Google Cloud Platform
# ============================================

GCS_PROJECT_ID=""
GCS_BUCKET=""
GCS_KEY_FILE="./config/gcs-key.json"

# ============================================
# File Storage
# ============================================

# Storage type: "local" | "s3" | "gcs"
STORAGE_TYPE="local"
UPLOAD_DIR="./uploads"
MAX_FILE_SIZE="52428800"  # 50MB in bytes

# S3 (if using AWS S3 or compatible)
S3_BUCKET=""
S3_REGION=""
S3_ACCESS_KEY=""
S3_SECRET_KEY=""
S3_ENDPOINT=""  # Optional: for S3-compatible services

# File optimization
OPTIMIZE_IMAGES="true"
IMAGE_QUALITY="80"
VIDEO_QUALITY="medium"

# ============================================
# Feature Flags
# ============================================

ENABLE_REGISTRATION="true"
ENABLE_OAUTH="true"
ENABLE_MFA="true"
ENABLE_AI="true"
FEATURE_MARKETPLACE_ENABLED="false"

# ============================================
# Rate Limiting
# ============================================

RATE_LIMIT_WINDOW_MS="60000"      # Window size in milliseconds (1 min)
RATE_LIMIT_MAX_REQUESTS="100"    # Max requests per window

# Specific limits
RATE_LIMIT_AUTH="5"               # Auth endpoints per 15 min
RATE_LIMIT_API="100"              # API endpoints per 15 min
RATE_LIMIT_UPLOAD="10"            # File uploads per hour

# ============================================
# Kubernetes Production Settings
# ============================================

# Replicas (managed by HPA in production)
K8S_MIN_REPLICAS="3"
K8S_MAX_REPLICAS="20"

# Resource limits (per pod)
K8S_MEMORY_REQUEST="512Mi"
K8S_MEMORY_LIMIT="1Gi"
K8S_CPU_REQUEST="250m"
K8S_CPU_LIMIT="1000m"

# ============================================
# Security (SOC II Compliance)
# ============================================

# Magic Link expiry (in minutes)
MAGIC_LINK_EXPIRY="15"

# Password reset expiry (in minutes)
PASSWORD_RESET_EXPIRY="60"

# Session expiry (in days)
SESSION_EXPIRY_DAYS="7"

# Data retention (in days)
DATA_RETENTION_DAYS="365"

# Failed login lockout
MAX_LOGIN_ATTEMPTS="5"
LOCKOUT_DURATION_MINUTES="15"

# MFA (TOTP)
MFA_ENABLED="true"
MFA_ISSUER="Power Industry"

# ============================================
# JWT Settings (for API authentication)
# ============================================

# JWT secret (generate with: openssl rand -hex 64)
JWT_SECRET=""

# Token expiration
JWT_ACCESS_TOKEN_EXPIRY="900"       # 15 minutes in seconds
JWT_REFRESH_TOKEN_EXPIRY="604800"   # 7 days in seconds
JWT_API_KEY_EXPIRY="31536000"       # 1 year in seconds

# ============================================
# CSRF Protection
# ============================================

# CSRF token expiry (in seconds)
CSRF_TOKEN_EXPIRY="3600"

# Skip CSRF for specific paths (comma-separated)
CSRF_SKIP_PATHS="/api/webhooks"

# ============================================
# Honeypot / Bot Protection
# ============================================

# Enable honeypot validation
HONEYPOT_ENABLED="true"

# Minimum form submission time (milliseconds)
HONEYPOT_MIN_TIME_MS="2000"

# Enable behavioral analysis
HONEYPOT_STRICT_MODE="false"

# ============================================
# Request Tracing
# ============================================

# Enable correlation IDs
ENABLE_REQUEST_TRACING="true"

# Log correlation ID header name
CORRELATION_ID_HEADER="x-correlation-id"

# ============================================
# OpenTelemetry (Distributed Tracing)
# ============================================

# Enable OpenTelemetry tracing
OTEL_ENABLED="false"

# OTLP exporter endpoint
OTEL_EXPORTER_OTLP_ENDPOINT="http://localhost:4318"

# Service name (defaults to APP_NAME)
OTEL_SERVICE_NAME=""

# ============================================
# Metrics
# ============================================

# Token to protect /api/metrics endpoint (generate with: openssl rand -hex 16)
METRICS_TOKEN=""

# ============================================
# Error Tracking (Sentry)
# ============================================

# Sentry DSN (optional)
SENTRY_DSN=""

# ============================================
# Request Limits
# ============================================

# Max request body size in bytes (default 1MB)
MAX_REQUEST_BODY_SIZE="1048576"

# Max upload size in bytes (default 50MB)
MAX_UPLOAD_SIZE="52428800"

# Request timeout in milliseconds (default 30s)
REQUEST_TIMEOUT_MS="30000"

# ============================================
# App Version (set at build time)
# ============================================

# App version for health checks and observability
APP_VERSION="1.0.0"

# ============================================
# Admin
# ============================================

# Initial admin account (change in production!)
ADMIN_EMAIL="admin@example.com"
ADMIN_PASSWORD="Admin123!"

# ============================================
# Feature Flags
# ============================================

FEATURE_OAUTH_ENABLED="true"
FEATURE_MAGIC_LINK_ENABLED="true"
FEATURE_AI_ENABLED="true"
FEATURE_MARKETPLACE_ENABLED="false"

# ============================================
# Monitoring & Alerts (Optional)
# ============================================

# Sentry (error tracking)
SENTRY_DSN=""

# Slack (alerts)
SLACK_WEBHOOK_URL=""

# PagerDuty (critical alerts)
PAGERDUTY_API_KEY=""
